# Application Configuration
NODE_ENV=development
PORT=3000
API_PREFIX=api/v1

# CORS Configuration
CORS_ORIGIN=http://localhost:3000,http://localhost:3001
CORS_CREDENTIALS=true

# GraphQL Configuration
GRAPHQL_PLAYGROUND=true
GRAPHQL_INTROSPECTION=true

# Database Configuration
DATABASE_URL=postgresql://username:password@localhost:5432/business_management
DATABASE_SSL=false

# Redis Configuration
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# JWT Configuration (REQUIRED)
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=15m
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-this-in-production
JWT_REFRESH_EXPIRES_IN=7d
JWT_ISSUER=business-management-platform
JWT_AUDIENCE=business-management-platform
JWT_ALGORITHM=HS256

# Password Security
BCRYPT_ROUNDS=12
PASSWORD_MIN_LENGTH=8
PASSWORD_MAX_LENGTH=128
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL_CHARS=true
PASSWORD_PREVENT_REUSE=5
PASSWORD_MAX_AGE_DAYS=90

# Session Management
MAX_SESSIONS_PER_USER=5
SESSION_TIMEOUT=15m
REMEMBER_ME_TIMEOUT=30d
SESSION_CLEANUP_INTERVAL=1h
SESSION_EXTEND_ON_ACTIVITY=true
SESSION_REQUIRE_REAUTH_HOURS=24

# Security Configuration
MAX_FAILED_ATTEMPTS=5
LOCKOUT_DURATION=900000
PROGRESSIVE_LOCKOUT=true
RATE_LIMIT_WINDOW=300000
RATE_LIMIT_MAX=10
SUSPICIOUS_ACTIVITY_THRESHOLD=20
DEVICE_TRUST_THRESHOLD=70
RISK_SCORE_THRESHOLD=50

# Trusted Networks (comma-separated CIDR blocks)
TRUSTED_NETWORKS=192.168.1.0/24,10.0.0.0/8

# MFA Configuration
MFA_ISSUER=Business Management Platform
MFA_APP_NAME=Business Management Platform
MFA_BACKUP_CODES_COUNT=10
MFA_TOKEN_WINDOW=1
MFA_QR_CODE_SIZE=200
MFA_ENFORCE_FOR_ROLES=super_admin,tenant_admin
MFA_GRACE_PERIOD_DAYS=7

# WebAuthn Configuration (Optional)
WEBAUTHN_ENABLED=false
WEBAUTHN_RP_NAME=Business Management Platform
WEBAUTHN_RP_ID=localhost
WEBAUTHN_ORIGIN=http://localhost:3000
WEBAUTHN_TIMEOUT=60000
WEBAUTHN_USER_VERIFICATION=preferred
WEBAUTHN_ATTESTATION=none

# Permission System
PERMISSIONS_CACHE_TIMEOUT=900
DEFAULT_USER_ROLE=employee
ADMIN_ROLES=super_admin,tenant_admin
MANAGER_ROLES=super_admin,tenant_admin,manager
PERMISSION_INHERITANCE=true
PERMISSION_WILDCARDS=true
POLICY_ENGINE=advanced

# Audit & Compliance
AUDIT_ENABLED=true
AUDIT_RETENTION_DAYS=2555
AUDIT_LOG_FAILED_ATTEMPTS=true
AUDIT_LOG_SUCCESSFUL_LOGINS=true
AUDIT_LOG_PERMISSION_CHANGES=true
AUDIT_LOG_SECURITY_EVENTS=true
AUDIT_LOG_DATA_ACCESS=true
AUDIT_REAL_TIME_ALERTS=false
AUDIT_COMPLIANCE_MODE=false

# Social Authentication (Optional)
GOOGLE_AUTH_ENABLED=false
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_SCOPE=email,profile

FACEBOOK_AUTH_ENABLED=false
FACEBOOK_CLIENT_ID=
FACEBOOK_CLIENT_SECRET=
FACEBOOK_SCOPE=email

GITHUB_AUTH_ENABLED=false
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
GITHUB_SCOPE=user:email

# Risk Assessment
RISK_ASSESSMENT_ENABLED=true
RISK_LOCATION_WEIGHT=0.2
RISK_LOCATION_ENABLED=true
RISK_DEVICE_WEIGHT=0.25
RISK_DEVICE_ENABLED=true
RISK_BEHAVIOR_WEIGHT=0.3
RISK_BEHAVIOR_ENABLED=true
RISK_NETWORK_WEIGHT=0.15
RISK_NETWORK_ENABLED=true
RISK_TIME_WEIGHT=0.1
RISK_TIME_ENABLED=true

# Risk Thresholds
RISK_THRESHOLD_LOW=25
RISK_THRESHOLD_MEDIUM=50
RISK_THRESHOLD_HIGH=75
RISK_THRESHOLD_CRITICAL=90

# Risk Actions (comma-separated)
RISK_ACTIONS_MEDIUM=require_mfa
RISK_ACTIONS_HIGH=require_mfa,require_approval
RISK_ACTIONS_CRITICAL=block_access,alert_admin

# Compliance Frameworks (Optional)
GDPR_COMPLIANCE=false
GDPR_DATA_RETENTION_DAYS=2555
GDPR_CONSENT_REQUIRED=true
GDPR_RIGHT_TO_ERASURE=true

SOX_COMPLIANCE=false
SOX_SEGREGATION_OF_DUTIES=true
SOX_APPROVAL_WORKFLOWS=true
SOX_AUDIT_TRAIL=true

HIPAA_COMPLIANCE=false
HIPAA_ENCRYPTION_REQUIRED=true
HIPAA_ACCESS_LOGGING=true
HIPAA_MINIMUM_NECESSARY=true

# Threat Detection
THREAT_DETECTION_ENABLED=true
BRUTE_FORCE_THRESHOLD=10
SUSPICIOUS_LOCATION_THRESHOLD=5
DEVICE_ANOMALY_THRESHOLD=3
BEHAVIOR_ANOMALY_THRESHOLD=7
REAL_TIME_MONITORING=true

# Logging
LOG_LEVEL=info